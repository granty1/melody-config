(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cd50104"],{"064b":function(e,t,s){"use strict";var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-collapse-item",{attrs:{disabled:e.disabled,name:e.p+"-"+e.title}},[s("template",{slot:"title"},[s("div",{staticStyle:{width:"100%","font-size":"16px"},on:{click:e.modify}},[e._v(" "+e._s(e.title)+" ")])]),e._t("default")],2)],1)},r=[],o=s("4360");function a(e){o["a"].commit("modifyActiveCards",e)}var i={data(){return{p:""===this.prefix?this.$route.name:this.prefix}},props:{title:{type:String,default:""},disabled:{type:Boolean,default:!1},remember:{type:Boolean,default:!0},prefix:{type:String,default:""}},methods:{modify(){this.remember&&(""===this.prefix?a(this.$route.name+"-"+this.title):a(this.prefix+"-"+this.title))}}},c=i,n=(s("37b0"),s("2877")),d=Object(n["a"])(c,l,r,!1,null,"74180b3e",null);t["a"]=d.exports},"097e":function(e,t,s){"use strict";var l=s("d5fb"),r=s.n(l);r.a},2148:function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-form",{ref:"config",attrs:{"label-position":"top",model:e.config,rules:e.secureRules,"status-icon":""}},[s("melody-card",[s("melody-card-item",{attrs:{title:"Security headers"}},[s("el-form-item",{attrs:{label:"Enable HTTP secure middleware"}},[s("el-switch",{on:{change:e.switchHttpSecure},model:{value:e.enableHttpSecure,callback:function(t){e.enableHttpSecure=t},expression:"enableHttpSecure"}}),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" Security headers增强了API中的安全性，并且是可选的。您可以添加AllowedHosts、SSL、HSTS选项和其他安全策略。 ")])],1),e.enableHttpSecure?[s("div",[s("span",{staticClass:"small_title"},[e._v("1.Allowed hosts")]),s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{placeholder:"hostname:port"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addHostHandle(t)}},model:{value:e.curHost,callback:function(t){e.curHost=t},expression:"curHost"}},[s("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.addHostHandle},slot:"append"},[e._v(" Add host ")])],1),e.melody_httpsecure.allowed_hosts?s("div",[e._l(e.melody_httpsecure.allowed_hosts,(function(t,l){return[s("el-tag",{key:l,style:0==l?{}:{"margin-left":"10px"},attrs:{type:"info",closable:"","disable-transitions":!1},on:{close:function(t){return e.removeHostHandle(l)}}},[e._v(" "+e._s(t)+" ")])]}))],2):e._e(),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 允许的完全限定域名列表，以及原始端口。格式: "),s("code",[e._v("主机名:端口")]),e._v("。当列表为空时，接受任何要连接的主机名。例如"),s("code",[e._v("example\\\\.com")]),e._v("、"),s("code",[e._v(".*\\\\.example\\\\.com")]),e._v("都是合法的。 ")])],1)],1),s("div",[s("span",{staticClass:"small_title"},[e._v("2.SSL Options")]),s("el-form-item",{attrs:{label:""}},[s("el-row",[s("el-col",{attrs:{span:16}},[s("el-input",{attrs:{clearable:"",disabled:!e.melody_httpsecure.ssl_redirect,placeholder:"ssl host domain"},model:{value:e.melody_httpsecure.ssl_host,callback:function(t){e.$set(e.melody_httpsecure,"ssl_host",t)},expression:"melody_httpsecure.ssl_host"}},[s("el-checkbox",{attrs:{slot:"prepend"},slot:"prepend",model:{value:e.melody_httpsecure.ssl_redirect,callback:function(t){e.$set(e.melody_httpsecure,"ssl_redirect",t)},expression:"melody_httpsecure.ssl_redirect"}},[e._v("Force SSL")])],1)],1),s("el-col",{attrs:{offset:1,span:7}},[s("el-input",{attrs:{clearable:"",disabled:!e.melody_httpsecure.ssl_redirect,placeholder:"port"},model:{value:e.melody_httpsecure.ssl_port,callback:function(t){e.$set(e.melody_httpsecure,"ssl_port",t)},expression:"melody_httpsecure.ssl_port"}})],1),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 如果"),s("code",[e._v("Force SSL")]),e._v("设置为"),s("code",[e._v("true")]),e._v("，则所有HTTP请求都将重定向到HTTPS。如果用于重定向到https的主机名与当前主机不同，请在输入框指定host和port，否则默认认为https的主机不变。 ")])],1)],1),s("el-form-item",{attrs:{label:"SSL Certificate"}},[s("el-input",{attrs:{clearable:"",placeholder:"/path/to/cert"},model:{value:e.melody_httpsecure.ssl_certificate,callback:function(t){e.$set(e.melody_httpsecure,"ssl_certificate",t)},expression:"melody_httpsecure.ssl_certificate"}}),s("div",{staticStyle:{"font-size":"12px"}},[s("code",[e._v("RSA")]),e._v("证书的绝对路径，以备您使用。"),s("code",[e._v("该配置暂未开发完整，配置不会产生效果。")])])],1),s("el-form-item",{attrs:{label:"SSL Private key"}},[s("el-input",{attrs:{clearable:"",placeholder:"/path/to/private/key"},model:{value:e.melody_httpsecure.ssl_private_key,callback:function(t){e.$set(e.melody_httpsecure,"ssl_private_key",t)},expression:"melody_httpsecure.ssl_private_key"}}),s("div",{staticStyle:{"font-size":"12px"}},[s("code",[e._v("RSA")]),e._v("私钥的绝对路径。"),s("code",[e._v("该配置暂未开发完整，配置不会产生效果。")])])],1),s("el-form-item",{attrs:{label:"SSL Proxy Headers"}},[s("table",{staticClass:"table table-striped",staticStyle:{"text-align":"center"}},[s("tbody",[s("tr",[s("th",{staticClass:"proxy_headers_title"},[e._v("SSL Proxy header")]),s("th",{staticClass:"proxy_headers_title"},[e._v("Header value")]),s("th")]),e._l(e.melody_httpsecure.ssl_proxy_headers,(function(t,l,r){return[s("tr",{key:"header_"+r},[s("td",[e._v(e._s(l))]),s("td",[e._v(e._s(t))]),s("td",[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.removeProxyHeaderClickHandle(l)}}},[s("i",{staticClass:"el-icon-close"})])],1)])]})),s("tr",[s("td",[s("el-input",{attrs:{clearable:"",placeholder:"X-Forwarded-Proto"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addProxyHeaderClickHandle(t)}},model:{value:e.curProxyHeader.header,callback:function(t){e.$set(e.curProxyHeader,"header",t)},expression:"curProxyHeader.header"}})],1),s("td",[s("el-input",{attrs:{clearable:"",placeholder:"https"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addProxyHeaderClickHandle(t)}},model:{value:e.curProxyHeader.value,callback:function(t){e.$set(e.curProxyHeader,"value",t)},expression:"curProxyHeader.value"}})],1),s("td",[s("el-button",{attrs:{type:"text info"},on:{click:e.addProxyHeaderClickHandle}},[s("i",{staticClass:"el-icon-plus"})])],1)])],2)]),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" SSL Proxy Headers是一组键值对，其关联值指示有效的"),s("code",[e._v("https")]),e._v("请求。使用Nginx时很有用，例如："),s("code",[e._v("“X-Forwarded-Proto”：“https”")])])])],1),s("div",[s("span",{staticClass:"small_title"},[e._v("3.HTTP Strict Transport Security (HSTS)")]),s("el-form-item",{attrs:{label:"",prop:"extra_config.melody_httpsecure.sts_seconds"}},[s("div",{staticStyle:{"font-size":"12px"}},[e._v(" HSTS是一种网络安全策略机制，有助于保护网站免受协议降级攻击和cookie劫持。它允许web服务器声明web浏览器（或其他符合要求的用户代理）只应使用安全的HTTPS连接与之交互，而不应通过不安全的HTTP协议。使用时，与http的传入链接将在访问服务器之前转换为https。语法示例："),s("code",[e._v("Strict-Transport-Security: max-age=31536000; includeSubDomains")])]),s("el-input",{model:{value:e.melody_httpsecure.sts_seconds,callback:function(t){e.$set(e.melody_httpsecure,"sts_seconds",t)},expression:"melody_httpsecure.sts_seconds"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("max-age")]),s("span",{attrs:{slot:"append"},slot:"append"},[e._v("seconds")])]),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 严格传输安全标头的最大使用期限。设置为"),s("code",[e._v("0")]),e._v("将禁用HSTS！ ")])],1),s("el-form-item",{attrs:{label:""}},[s("el-checkbox",{attrs:{label:"Include also subdomains"},model:{value:e.melody_httpsecure.sts_include_subdomains,callback:function(t){e.$set(e.melody_httpsecure,"sts_include_subdomains",t)},expression:"melody_httpsecure.sts_include_subdomains"}}),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 如果将此值设置为true，则"),s("code",[e._v("includeS ubdomains")]),e._v("指令将附加到严格传输安全头 ")])],1)],1),s("div",[s("span",{staticClass:"small_title"},[e._v("4.Clickjacking")]),s("el-form-item",{attrs:{label:""}},[s("el-checkbox",{attrs:{label:"Enable clickjacking protection"},model:{value:e.melody_httpsecure.frame_deny,callback:function(t){e.$set(e.melody_httpsecure,"frame_deny",t)},expression:"melody_httpsecure.frame_deny"}}),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 通过添加头"),s("code",[e._v("X-Frame-Options:DENY")]),e._v("，在设置为"),s("code",[e._v("true")]),e._v("时提供服务器端的部分保护，防止点击劫持。 ")])],1),e.melody_httpsecure.frame_deny?[s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{clearable:"",placeholder:"DENY"},model:{value:e.melody_httpsecure.custom_frame_options_value,callback:function(t){e.$set(e.melody_httpsecure,"custom_frame_options_value",t)},expression:"melody_httpsecure.custom_frame_options_value"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("X-Frame-Options:")])]),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 或者使用自定义值: "),s("el-tag",{staticClass:"custom_frame_tag",attrs:{size:"small",type:"info"},on:{click:function(t){return e.frameTagClickHandle("DENY")}}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" DENY")]),s("el-tag",{staticClass:"custom_frame_tag",attrs:{size:"small",type:"info"},on:{click:function(t){return e.frameTagClickHandle("SAMEORIGIN")}}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" SAMEORIGIN")]),s("el-tag",{staticClass:"custom_frame_tag",attrs:{size:"small",type:"info"},on:{click:function(t){return e.frameTagClickHandle("ALLOW-FROM https://example.com")}}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" ALLOW-FROM")])],1)],1)]:e._e()],2),s("div",[s("span",{staticClass:"small_title"},[e._v("5.HTTP Public Key Pinning (HPKP)")]),s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{clearable:"",placeholder:'pin-sha256="base64=="; max-age=expireTime [; includeSubDomains][; report-uri="reportURI"]'},model:{value:e.melody_httpsecure.hpkp_public_key,callback:function(t){e.$set(e.melody_httpsecure,"hpkp_public_key",t)},expression:"melody_httpsecure.hpkp_public_key"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("Public-Key-Pins:")])]),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 允许HTTPS网站抵抗攻击者使用错误颁发或其他欺诈性证书进行的模拟。 ")])],1)],1),s("div",[s("span",{staticClass:"small_title"},[e._v("6.Sniffing")]),s("el-form-item",{attrs:{label:""}},[s("el-checkbox",{attrs:{label:"MIME-sniffing prevention"},model:{value:e.melody_httpsecure.content_type_nosniff,callback:function(t){e.$set(e.melody_httpsecure,"content_type_nosniff",t)},expression:"melody_httpsecure.content_type_nosniff"}}),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 当设置为"),s("code",[e._v("true")]),e._v("时，将阻止Internet Explorer从声明的内容类型之外对响应进行MIME嗅探。下载扩展时，这也适用于Chrome。通过设置"),s("code",[e._v("X-Content-Type-Options:nosniff")]),e._v("实现 ")])],1)],1),s("div",[s("span",{staticClass:"small_title"},[e._v("7.Cross-site scripting (XSS) protection")]),s("el-form-item",{attrs:{label:""}},[s("el-checkbox",{attrs:{label:"Browser cross-site scripting (XSS) filter"},model:{value:e.melody_httpsecure.browser_xss_filter,callback:function(t){e.$set(e.melody_httpsecure,"browser_xss_filter",t)},expression:"melody_httpsecure.browser_xss_filter"}}),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 如果设置为"),s("code",[e._v("true")]),e._v("，则会添加"),s("code",[e._v("X-XSS-Protection:'1; mode=block'")]),e._v("到响应头中。 ")])],1),s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{clearable:"",placeholder:"default-src:'self'"},model:{value:e.melody_httpsecure.content_security_policy,callback:function(t){e.$set(e.melody_httpsecure,"content_security_policy",t)},expression:"melody_httpsecure.content_security_policy"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("Content-Security-Policy:")])]),s("div",{staticStyle:{"font-size":"12px"}},[e._v(" 通过在标题中写入策略来启用内容安全策略（CSP） "),s("a",{attrs:{href:"https://content-security-policy.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("（参考资料）")]),e._v(" 。 ")])],1)],1)]:e._e()],2)],1)],1)],1)},r=[],o=s("9641"),a=s("064b"),i=s("6c4f"),c={name:"ResponseHeaderConfig",components:{MelodyCard:o["a"],MelodyCardItem:a["a"]},data(){let e=this.$store.getters.serviceConfig;return{secureRules:{extra_config:{melody_httpsecure:{sts_seconds:[{validator:i["a"],trigger:"blur"}]}}},config:e,enableHttpSecure:void 0!==e.extra_config.melody_httpsecure,melody_httpsecure:void 0==e.extra_config.melody_httpsecure?{allowed_hosts:[],ssl_redirect:!1,ssl_host:"",ssl_port:"",ssl_certificate:"",ssl_private_key:"",ssl_proxy_headers:{},sts_seconds:0,sts_include_subdomains:!1,frame_deny:!1,custom_frame_options_value:"",hpkp_public_key:"",content_type_nosniff:!1,browser_xss_filter:!1,content_security_policy:""}:e.extra_config.melody_httpsecure,curProxyHeader:{header:"",value:""},curHost:""}},methods:{switchHttpSecure(e){e?this.$store.commit("setExtraConfig",{name:"melody_httpsecure",config:this.melody_httpsecure}):this.$store.commit("removeExtraConfig",{name:"melody_httpsecure"})},addHostHandle(){let e=this.melody_httpsecure.allowed_hosts;-1==e.indexOf(this.curHost)&&(e.push(this.curHost),this.melody_httpsecure.allowed_hosts=e,this.curHost="")},removeHostHandle(e){this.melody_httpsecure.allowed_hosts.splice(e,1)},addProxyHeaderClickHandle(){if(this.curProxyHeader.header&&this.curProxyHeader.value){let e={};e[this.curProxyHeader.header]=this.curProxyHeader.value,this.melody_httpsecure.ssl_proxy_headers=Object.assign({},this.melody_httpsecure.ssl_proxy_headers,e)}},removeProxyHeaderClickHandle(e){this.$delete(this.melody_httpsecure.ssl_proxy_headers,e)},frameTagClickHandle(e){this.melody_httpsecure.custom_frame_options_value=e}},watch:{config:{handler:function(){this.$refs.config.validate().catch(e=>{console.log(e)}),this.$store.commit("updateServiceConfig",this.config),this.$store.commit("removeUselessPropsAtServiceConfigLevel")},deep:!0},melody_httpsecure:{handler:function(){this.$refs.config.validate(e=>{e&&this.$store.commit("setExtraConfig",{name:"melody_httpsecure",config:this.melody_httpsecure})})},deep:!0}}},n=c,d=(s("097e"),s("2877")),p=Object(d["a"])(n,l,r,!1,null,null,null);t["default"]=p.exports},"37b0":function(e,t,s){"use strict";var l=s("5f02"),r=s.n(l);r.a},"5f02":function(e,t,s){},"6c4f":function(e,t,s){"use strict";function l(e,t,s){return"undefined"===typeof t||""==t||/^\d+(ns|us|µs|ms|s|m|h)$/.test(t)?s():s(new Error("该字段必须以ns、us或µs、ms、s、m、h时间单位结尾，例如300ms"))}function r(e,t,s){return"undefined"===typeof t||""==t||/^[0-9]*$/.test(t)?s():s(new Error("该字段不能包含除数字以外的其他字符"))}s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return r}))},9641:function(e,t,s){"use strict";var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",{staticClass:"box-card item"},[s("el-collapse",{attrs:{value:e.activeList}},[e._t("default")],2)],1)],1)},r=[],o={computed:{activeList(){return this.$ls.get("active_cards")}}},a=o,i=s("2877"),c=Object(i["a"])(a,l,r,!1,null,"db2c75f6",null);t["a"]=c.exports},d5fb:function(e,t,s){}}]);
//# sourceMappingURL=chunk-1cd50104.7bfbd3e0.js.map